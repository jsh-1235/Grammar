<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>demo_8</title>
  <link href="../css/style.css" rel="stylesheet" text="text/css">

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <style></style>

  <script>
    // 서버와 클라이언트 간의 데이터를 주고 받는 형식으로서의 JSON과 페이지 리로드 없이 웹페이지 내용을 변겨할 수 있는 Ajax는
    // 웹 에플리케이션을 구축하는데 중요하다.
    // Asynchronous JavaScript and XML
    // XMLHttpRequest
    window.addEventListener("DOMContentLoaded", function () { });

    window.addEventListener("load", function () {
      document.getElementById("target_get").addEventListener("click", function (event) {
        // alert(event.target.id);
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "/study_web_browser/time");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            document.querySelector("#time_get").innerHTML = xhr.responseText;
          }
        };
        xhr.send();
      });

      document.getElementById("target_post").addEventListener("click", function (event) {
        // alert(event.target.id);
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/study_web_browser/time");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            document.querySelector("#time_post").innerHTML = xhr.responseText;
          }
        };
        xhr.send();
      });

      document.getElementById("execute").addEventListener("click", function (event) {
        // alert(event.target.id);
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/study_web_browser/date");
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            document.querySelector("#date_post").innerHTML = xhr.responseText;
          }
        };
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        var data = "";
        data += "timezone=" + document.getElementById("timezone").value;
        data += "&format=" + document.getElementById("format").value;
        xhr.send(data);
      });
    });
  </script>
</head>

<body>
  <h1 class="title">AJAX</h1>
  <div>
    <a class="menu" id="anchor" href="/study_web_browser">Back</a>
    <a class="menu" href="/">Home</a>
  </div>
  <hr>
  <p3>JQuery Event</p3>
  <hr>
  <button id="target_get">XMLHttpRequest GET</button>
  <button id="target_post">XMLHttpRequest POST</button>
  <p id="time_get"></p>
  <p id="time_post"></p>
  <hr>
  <div>
    <select id="timezone">
      <option value="Asia/Seoul">asia/seoul</option>
      <option value="America/New_York">America/New_York</option>
    </select>
    <select id="format">
      <option value="Y-m-d H:i:s">Y-m-d H:i:s</option>
      <option value="Y-m-d">Y-m-d</option>
    </select>
    <input id="execute" type="button" value="execute">
    <p id="date_post"></p>
  </div>
</body>

</html>